@model AlphaWorkout.Models.ProfilePageViewModel

@{
    ViewData["Title"] = "Profile Page";
}

<h1>@ViewData["Title"]</h1>
<p>Welcome to your Profile Page, @Model.Username!</p>

<!-- Display profile picture if it exists -->
@if (!string.IsNullOrEmpty(Model.ProfilePicturePath))
{
    <img src="@Model.ProfilePicturePath" alt="Profile Picture" style="width: 150px; height: 150px; border-radius: 50%;" />
}

<!-- Form to upload profile picture -->
<h2>Upload Profile Picture</h2>
<form asp-action="UploadProfilePicture" method="post" enctype="multipart/form-data">
    <div class="form-group">
        <label for="ProfilePicture">Profile Picture:</label>
        <input type="file" class="form-control" id="ProfilePicture" name="ProfilePicture" required />
    </div>
    <button type="submit" class="btn btn-primary">Upload</button>
</form>

<!-- Add the Onboarding button -->
<a class="btn btn-primary" asp-controller="Onboarding" asp-action="Index">Complete Onboarding</a>

<!-- Display the onboarding data in a table -->
@if (Model.FitnessGoals != null)
{
    <h2>Your Onboarding Information</h2>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Category</th>
                <th>Information</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Fitness Goals</td>
                <td>@Model.FitnessGoals</td>
            </tr>
            <tr>
                <td>Demographics</td>
                <td>@Model.Demographics</td>
            </tr>
            <tr>
                <td>Fitness Level</td>
                <td>@Model.FitnessLevel</td>
            </tr>
            <tr>
                <td>Exercise Preferences</td>
                <td>@Model.ExercisePreferences</td>
            </tr>
            <tr>
                <td>Past Injury</td>
                <td>@Model.PastInjury</td>
            </tr>
        </tbody>
    </table>
}

<!-- Add weight entry form -->
<h2>Track Your Weight</h2>
<form asp-action="AddWeight" method="post">
    <div class="form-group">
        <label for="weight">Weight (kg):</label>
        <input type="number" step="0.01" class="form-control" id="weight" name="weight" required />
    </div>
    <button type="submit" class="btn btn-primary">Add Weight</button>
</form>

<!-- Steps Tracking -->
<h2>Track Your Steps</h2>
<form asp-action="AddSteps" method="post">
    <div class="form-group">
        <label for="steps">Steps Taken Today:</label>
        <input type="number" class="form-control" id="steps" name="steps" required />
    </div>
    <div class="form-group">
        <label for="stepsGoal">Daily Step Goal:</label>
        <input type="number" class="form-control" id="stepsGoal" name="stepsGoal" required />
    </div>
    <button type="submit" class="btn btn-primary">Add Steps</button>
</form>

<!-- Water Intake Tracking -->
<h2>Track Your Water Intake</h2>
<form asp-action="AddWaterIntake" method="post">
    <div class="form-group">
        <label for="waterIntake">Water Intake (Liters):</label>
        <input type="number" step="0.01" class="form-control" id="waterIntake" name="waterIntake" required />
    </div>
    <div class="form-group">
        <label for="waterGoal">Daily Water Goal (Liters):</label>
        <input type="number" step="0.01" class="form-control" id="waterGoal" name="waterGoal" required />
    </div>
    <button type="submit" class="btn btn-primary">Add Water Intake</button>
</form>

<!-- Calorie Intake Tracking -->
<h2>Track Your Calorie Intake</h2>
<form asp-action="AddCalorieIntake" method="post">
    <div class="form-group">
        <label for="calories">Calorie Intake (kcal):</label>
        <input type="number" class="form-control" id="calories" name="calories" required />
    </div>
    <div class="form-group">
        <label for="calorieGoal">Daily Calorie Goal (kcal):</label>
        <input type="number" class="form-control" id="calorieGoal" name="calorieGoal" required />
    </div>
    <button type="submit" class="btn btn-primary">Add Calorie Intake</button>
</form>

<!-- Running Distance Tracking -->
<h2>Track Your Running Distance</h2>
<form asp-action="AddRunningDistance" method="post">
    <div class="form-group">
        <label for="distance">Running Distance (km):</label>
        <input type="number" step="0.01" class="form-control" id="distance" name="distance" required />
    </div>
    <div class="form-group">
        <label for="distanceGoal">Daily Running Goal (km):</label>
        <input type="number" step="0.01" class="form-control" id="distanceGoal" name="distanceGoal" required />
    </div>
    <button type="submit" class="btn btn-primary">Add Running Distance</button>
</form>

<!-- Sleep Tracking -->
<h2>Track Your Sleep</h2>
<form asp-action="AddSleep" method="post">
    <div class="form-group">
        <label for="sleep">Sleep (hours):</label>
        <input type="number" step="0.01" class="form-control" id="sleep" name="sleep" required />
    </div>
    <div class="form-group">
        <label for="sleepGoal">Daily Sleep Goal (hours):</label>
        <input type="number" step="0.01" class="form-control" id="sleepGoal" name="sleepGoal" required />
    </div>
    <button type="submit" class="btn btn-primary">Add Sleep</button>
</form>

<!-- Display weight entries -->
@if (Model.WeightEntries != null && Model.WeightEntries.Any())
{
    <h3>Your Weight Entries</h3>
    <canvas id="weightChart" width="400" height="200"></canvas>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        var ctx = document.getElementById('weightChart').getContext('2d');

        // Debugging: Log data to the console
        var weightDates = @Html.Raw(Json.Serialize(Model.WeightEntries.Select(w => w.Date.ToString("MM/dd/yyyy")).ToList()));
        var weightValues = @Html.Raw(Json.Serialize(Model.WeightEntries.Select(w => w.Weight).ToList()));

        console.log("Weight Dates:", weightDates);
        console.log("Weight Values:", weightValues);

        var weightData = {
            labels: weightDates,
            datasets: [{
                label: 'Weight (kg)',
                data: weightValues,
                backgroundColor: 'rgba(54, 162, 235, 0.2)',
                borderColor: 'rgba(54, 162, 235, 1)',
                borderWidth: 1
            }]
        };
        var weightChart = new Chart(ctx, {
            type: 'line',
            data: weightData,
            options: {
                scales: {
                    y: {
                        beginAtZero: false
                    }
                }
            }
        });
    </script>
}

<!-- Button to generate workout plan -->
<h2>Generate Workout Plan</h2>
<form asp-action="GenerateWorkoutPlan" method="post">
    <button type="submit" class="btn btn-primary">Generate Workout Plan</button>
</form>

<!-- Display the workout plan -->
@if (Model.WorkoutPlan != null && Model.WorkoutPlan.Any())
{
    <h3>Your Workout Plan</h3>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Day</th>
                <th>Exercise</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var day in Model.WorkoutPlan)
            {
                <tr>
                    <td>@day.Key</td>
                    <td>@day.Value</td>
                </tr>
            }
        </tbody>
    </table>
}
