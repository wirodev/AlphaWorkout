@model AlphaWorkout.Models.ProfilePageViewModel

@{
    ViewData["Title"] = "Profile Page";
}

<h1>@ViewData["Title"]</h1>
<p>Welcome to your Profile Page, @Model.Username!</p>

<!-- Display profile picture if it exists -->
@if (!string.IsNullOrEmpty(Model.ProfilePicturePath))
{
    <img src="@Model.ProfilePicturePath" alt="Profile Picture" style="width: 150px; height: 150px; border-radius: 50%;" />
}
<br />
<br />
<br />
<!-- Form to upload profile picture -->
<h2>Upload Profile Picture</h2>
<form asp-action="UploadProfilePicture" method="post" enctype="multipart/form-data">
    <div class="form-group">
        <label for="ProfilePicture">Profile Picture:</label>
        <input type="file" class="form-control" id="ProfilePicture" name="ProfilePicture" required />
    </div>
    <button type="submit" class="btn btn-primary">Upload</button>
</form>
<br />
<br />
<br />
<!-- Add the Onboarding button -->
<a class="btn btn-primary" asp-controller="Onboarding" asp-action="Index">Complete Onboarding</a>
<br />
<br />
<br />
<!-- Display the onboarding data in a table -->
@if (Model.FitnessGoals != null)
{
    <h2>Your Onboarding Information</h2>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Category</th>
                <th>Information</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Fitness Goals</td>
                <td>@Model.FitnessGoals</td>
            </tr>
            <tr>
                <td>Demographics</td>
                <td>@Model.Demographics</td>
            </tr>
            <tr>
                <td>Fitness Level</td>
                <td>@Model.FitnessLevel</td>
            </tr>
            <tr>
                <td>Exercise Preferences</td>
                <td>@Model.ExercisePreferences</td>
            </tr>
            <tr>
                <td>Past Injury</td>
                <td>@Model.PastInjury</td>
            </tr>
        </tbody>
    </table>
}
<br />
<br />
<br />
<!-- Add weight entry form -->
<h2>Track Your Weight</h2>
<form asp-action="AddWeight" method="post">
    <div class="form-group">
        <label for="weight">Weight (kg):</label>
        <input type="number" step="0.01" class="form-control" id="weight" name="weight" required />
    </div>
    <button type="submit" class="btn btn-primary">Add Weight</button>
</form>
<br />
<br />
<br />
<!-- Display weight entries -->
@if (Model.WeightEntries != null && Model.WeightEntries.Any())
{
    <h3>Your Weight Entries</h3>
    <canvas id="weightChart" width="400" height="200"></canvas>
    <!-- Ensure Chart.js is loaded -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        var ctx = document.getElementById('weightChart').getContext('2d');

        // Debugging: Log data to the console
        var weightDates = @Html.Raw(Json.Serialize(Model.WeightEntries.Select(w => w.Date.ToString("MM/dd/yyyy")).ToList()));
        var weightValues = @Html.Raw(Json.Serialize(Model.WeightEntries.Select(w => w.Weight).ToList()));

        console.log("Weight Dates:", weightDates);
        console.log("Weight Values:", weightValues);

        var weightData = {
            labels: weightDates,
            datasets: [{
                label: 'Weight (kg)',
                data: weightValues,
                backgroundColor: 'rgba(54, 162, 235, 0.2)',
                borderColor: 'rgba(54, 162, 235, 1)',
                borderWidth: 1
            }]
        };
        var weightChart = new Chart(ctx, {
            type: 'line',
            data: weightData,
            options: {
                scales: {
                    y: {
                        beginAtZero: false
                    }
                }
            }
        });
    </script>
}
<br />
<br />
<br />
<!-- Button to generate workout plan -->
<h2>Generate Workout Plan</h2>
<form asp-action="GenerateWorkoutPlan" method="post">
    <button type="submit" class="btn btn-primary">Generate Workout Plan</button>
</form>
<br />
<br />
<br />
<!-- Display the workout plan -->
@if (Model.WorkoutPlan != null)
{
    <h3>Your Workout Plan</h3>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Day</th>
                <th>Exercise</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var entry in Model.WorkoutPlan)
            {
                <tr>
                    <td>@entry.Key</td>
                    <td>@entry.Value</td>
                </tr>
            }
        </tbody>
    </table>
}
